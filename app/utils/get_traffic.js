/**
 * Created by lancemock on 10/7/14.
 */
/*
 http://www.mapquestapi.com/traffic/v2/incidents?key=Fmjtd%7Cluurnu6tnl%2Cbw%3Do5-9wbw50&callback=handleIncidentsResponse&boundingBox=37.997403,-122.694754,37.563245,-122.145438&filters=construction,incidents&inFormat=kvp&outFormat=json
 handleIncidentsResponse(
  { "incidents" : [ { "delayFromFreeFlow" : 0.02,
    "delayFromTypical" : 0.02,
    "distance" : 0.01,
    "endTime" : "2014-10-08T02:59:00",
    "eventCode" : 701,
    "fullDesc" : "Delays expected and intermittent lane closures due to construction on CA-1 Coast Highway Northbound at San Pedro Avenue / Linda Mar Boulevard.",
    "iconURL" : "http://api.mqcdn.com/mqtraffic/const_mod.png",
    "id" : "1650872094",
    "impacting" : true,
    "lat" : 37.595961000000003,
    "lng" : -122.503896,
    "severity" : 2,
    "shortDesc" : "CA-1 Coast Highway N/B : Construction at San Pedro Avenue ",
    "startTime" : "2014-10-01T03:00:00",
    "tmcs" : [ "105P06309" ],
    "type" : 1
  },
    { "delayFromFreeFlow" : 0,
      "delayFromTypical" : 0,
      "distance" : 0,
      "endTime" : "2015-04-02T02:59:00",
      "eventCode" : 701,
      "fullDesc" : "Parking restrictions in force due to construction on Clarendon Avenue both ways between Laguna Honda Boulevard and Twin Peaks Boulevard.",
      "iconURL" : "http://api.mqcdn.com/mqtraffic/const_mod.png",
      "id" : "820013344",
      "impacting" : true,
      "lat" : 37.759045999999998,
      "lng" : -122.448469,
      "severity" : 2,
      "shortDesc" : "Clarendon Av : Parking restrictions in force at Laguna Honda Blvd",
      "startTime" : "2012-07-20T03:00:00",
      "tmcs" : [  ],
      "type" : 1
    },
    { "delayFromFreeFlow" : 0,
      "delayFromTypical" : 0,
      "distance" : 0,
      "endTime" : "2015-04-01T02:59:00",
      "eventCode" : 474,
      "fullDesc" : "I-80 Westbound exit ramp closed at Folsom Street.",
      "iconURL" : "http://api.mqcdn.com/mqtraffic/const_mod.png",
      "id" : "1609111728",
      "impacting" : true,
      "lat" : 37.787996999999997,
      "lng" : -122.39362199999999,
      "severity" : 3,
      "shortDesc" : "I-80 W/B : Exit ramp closed at Folsom Street ",
      "startTime" : "2014-09-22T19:00:00",
      "tmcs" : [  ],
      "type" : 1
    },
    { "delayFromFreeFlow" : 0,
      "delayFromTypical" : 0,
      "distance" : 0,
      "endTime" : "2015-01-01T02:59:00",
      "eventCode" : 474,
      "fullDesc" : "Delays expected and exit ramp closed due to construction on Fremont Street Eastbound at Folsom Street.",
      "iconURL" : "http://api.mqcdn.com/mqtraffic/const_mod.png",
      "id" : "1650872096",
      "impacting" : true,
      "lat" : 37.787996999999997,
      "lng" : -122.39362199999999,
      "severity" : 2,
      "shortDesc" : "Fremont Street E/B : Exit ramp closed at Folsom Street ",
      "startTime" : "2014-10-03T19:00:00",
      "tmcs" : [ "105N10560" ],
      "type" : 1
    },
    { "delayFromFreeFlow" : 0,
      "delayFromTypical" : 0,
      "distance" : 0.029999999999999999,
      "endTime" : "2015-01-01T02:59:00",
      "eventCode" : 475,
      "fullDesc" : "Fremont Street Westbound exit ramp blocked; delays expected due to construction at Folsom Street.",
      "iconURL" : "http://api.mqcdn.com/mqtraffic/const_mod.png",
      "id" : "1650872098",
      "impacting" : false,
      "lat" : 37.787996999999997,
      "lng" : -122.39362199999999,
      "severity" : 2,
      "shortDesc" : "Fremont Street W/B : Exit ramp blocked at Folsom Street ",
      "startTime" : "2014-10-01T03:00:00",
      "tmcs" : [ "105P10560" ],
      "type" : 1
    },
    { "delayFromFreeFlow" : 0,
      "delayFromTypical" : 0,
      "distance" : 0.32000000000000001,
      "endTime" : "2014-12-24T02:59:00",
      "eventCode" : 406,
      "fullDesc" : "US-101 Northbound entry ramp closed due to barrier repairs at Broadway.",
      "iconURL" : "http://api.mqcdn.com/mqtraffic/const_mod.png",
      "id" : "1649356242",
      "impacting" : false,
      "lat" : 37.587240000000001,
      "lng" : -122.34851999999999,
      "severity" : 2,
      "shortDesc" : "US-101 N/B : Entry ramp closed at Broadway ",
      "startTime" : "2014-01-30T03:01:00",
      "tmcs" : [ "105P04169" ],
      "type" : 1
    },
    { "delayFromFreeFlow" : 0,
      "delayFromTypical" : 0,
      "distance" : 0.51000000000000001,
      "endTime" : "2014-10-07T15:05:34",
      "eventCode" : 901,
      "fullDesc" : "I-80 Eastbound lane blocked on exit ramp due to obstruction on the road at I-580 John T Knox Freeway.",
      "iconURL" : "http://api.mqcdn.com/mqtraffic/incid_mod.png",
      "id" : "1661837338",
      "impacting" : false,
      "lat" : 37.889707000000001,
      "lng" : -122.308238,
      "severity" : 3,
      "shortDesc" : "I-80 E/B : Lane blocked on exit ramp at I-580 John T Knox Freeway ",
      "startTime" : "2014-10-07T12:32:07",
      "tmcs" : [ "105P04415" ],
      "type" : 4
    },
    { "delayFromFreeFlow" : 0,
      "delayFromTypical" : 0,
      "distance" : 0.02,
      "endTime" : "2014-10-07T14:38:10",
      "eventCode" : 201,
      "fullDesc" : "Accident on Telegraph Avenue both ways at 29th Street.",
      "iconURL" : "http://api.mqcdn.com/mqtraffic/incid_mod.png",
      "id" : "1661876060",
      "impacting" : false,
      "lat" : 37.818241999999998,
      "lng" : -122.267381,
      "severity" : 2,
      "shortDesc" : "Telegraph Avenue : Accident at 29th Street ",
      "startTime" : "2014-10-07T12:41:20",
      "tmcs" : [ "105N11145",
        "105P11145"
      ],
      "type" : 4
    },
    { "delayFromFreeFlow" : 0,
      "delayFromTypical" : 0,
      "distance" : 0.17999999999999999,
      "endTime" : "2014-10-31T18:30:00",
      "eventCode" : 406,
      "fullDesc" : "CA-13 Warren Freeway Southbound entry ramp closed due to construction at Carson Street.",
      "iconURL" : "http://api.mqcdn.com/mqtraffic/const_mod.png",
      "id" : "1634597170",
      "impacting" : false,
      "lat" : 37.793866000000001,
      "lng" : -122.182005,
      "severity" : 2,
      "shortDesc" : "CA-13 Warren Freeway S/B : Entry ramp closed at Carson Street ",
      "startTime" : "2014-09-30T13:01:00",
      "tmcs" : [ "105N04580" ],
      "type" : 1
    },
    { "delayFromFreeFlow" : 0.02,
      "delayFromTypical" : 0.02,
      "distance" : 0.17999999999999999,
      "endTime" : "2014-10-07T17:01:00",
      "eventCode" : 406,
      "fullDesc" : "CA-13 Southbound entry ramp closed due to landscaping work at Carson Street.",
      "iconURL" : "http://api.mqcdn.com/mqtraffic/const_mod.png",
      "id" : "1656596368",
      "impacting" : false,
      "lat" : 37.793869999999998,
      "lng" : -122.18197000000001,
      "severity" : 2,
      "shortDesc" : "CA-13 S/B : Entry ramp closed at Carson Street ",
      "startTime" : "2014-10-07T12:30:00",
      "tmcs" : [ "105N04580" ],
      "type" : 1
    }
  ],
    "info" : { "copyright" : { "imageAltText" : "© 2014 MapQuest, Inc.",
    "imageUrl" : "http://api.mqcdn.com/res/mqlogo.gif",
    "text" : "© 2014 MapQuest, Inc."
  },
    "messages" : [  ],
      "statuscode" : 0
  },
    "mqURL" : "http://www.mapquest.com/maps?traffic=1&latitude=37.7803241&longitude=-122.4200961"
  }
);
*/

var GetTraffic = Ember.Object.extend({

  retrieve: function(controller, varName) {
    $.ajax({
      url: '//www.mapquestapi.com/traffic/v2/incidents?key=Fmjtd%7Cluurnu6tnl%2Cbw%3Do5-9wbw50&boundingBox=37.997403,-122.694754,37.563245,-122.145438&filters=construction,incidents&inFormat=kvp&outFormat=json',
      async: false,
      success:function(result) {
        controller.set(varName, Ember.ArrayProxy.create({ content: Ember.A(result.incidents) }));
      }});
  }
});

export default GetTraffic;